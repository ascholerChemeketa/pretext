// Default pretext theme. The dual color palette version is "prerolled".
// Other palettes (single, muted) are available via rebuilding the css.

@use "sass:map";

// Imports in this file should be relative to css root
@use 'components/pretext';
@use 'components/pretext_add_on';
@use 'shell_default-modern';
@use 'banner_default-modern';
@use 'navbar_default-modern';
@use 'toc_default-modern';
@use 'components/knowls';

// "style" components 
@use 'components/blocks/assemblages-default';
@use 'components/blocks/asides-default';
@use 'components/blocks/proofs';

// fonts and colors
// $body-font: 'Open Sans' !default;
// $heading-font: 'Roboto' !default;
@use 'fonts/fonts-google'; // with ($body: $body-font, $heading: $heading-font);

$palette: 'dual' !default;
$primary-color: #2a5ea4 !default;
$secondary-color: #a11c1c !default;
$primary-color-dark: #829ab1 !default;
$background-color-dark: #23241f !default;

@use "colors/color-helpers" as colorHelpers;
@use 'colors/palette-single' as palette-single with (
    $primary-color: $primary-color,
);
@use 'colors/palette-dual' as palette-dual with (
    $primary-color: $primary-color,
    $secondary-color: $secondary-color,
);
@use 'colors/palette-muted' as palette-muted with (
    $primary-color: $primary-color,
);
@use 'colors/palette-dark' as palette-dark with (
    $primary-color: $primary-color-dark,
    $background-color: $background-color-dark,
);

// Sample of how to override a color in a palette
// palette-dual.$colors: map.merge(palette-single.$colors, (
//     "bodytitle": var(--primary-color-white-50),
// ));

.hide-type .codenumber::after {
    content: " -";
}

.ptx-content section > .heading.hide-type {
    padding-bottom: 3px;
    margin-bottom: 0.5em;
}

@if $palette != 'dual' {
    .ptx-content section > .heading.hide-type {
        @if $palette == 'muted' {
            border-bottom: 2px solid #eee;
        } @else {
            // dark or single
            border-bottom: 2px solid var(--primary-color);
            .ptx-content section > h2.heading.hide-type {
                border-bottom-width: 10px;
            }
            .ptx-content section > h3.heading.hide-type {
                border-bottom-width: 5px;
            }
        }
    }
} @else {
    .ptx-content section > .heading.hide-type {
        border-bottom: 2px solid #eee;
    }
    .ptx-content section > h2.heading.hide-type {
        border-bottom-width: 4px;
    }
    .ptx-content section > h3.heading.hide-type {
        border-bottom-width: 3px;
    }
}


:root {
    color-scheme: light;
    &:not(.dark-mode) {  // prevent variable leak through to dark
        @if $palette == 'dual' {
            @include colorHelpers.scss-to-css(palette-dual.$colors);
        } @else if $palette == 'single' {
            @include colorHelpers.scss-to-css(palette-single.$colors);
        } @else if $palette == 'muted' {
            @include colorHelpers.scss-to-css(palette-muted.$colors);
        }
    }
}

:root.dark-mode {
    color-scheme: dark;

    @include colorHelpers.scss-to-css(palette-dark.$colors);

    .ptx-content .autopermalink {
        opacity: 0; // permalinks are extra-distracting when in dark mode
    }

    .ptx-content section > .heading.hide-type {
        border-bottom-color: var(--primary-color-black-30);
    }
}
